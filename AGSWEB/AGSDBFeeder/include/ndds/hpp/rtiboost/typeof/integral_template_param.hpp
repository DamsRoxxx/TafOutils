// Copyright (C) 2005 Arkadiy Vertleyb
// Distributed under the Boost Software License, Version 1.0. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

#ifndef RTIBOOST_TYPEOF_INTEGRAL_TEMPLATE_PARAM_HPP_INCLUDED
#define RTIBOOST_TYPEOF_INTEGRAL_TEMPLATE_PARAM_HPP_INCLUDED

#define RTIBOOST_TYPEOF_unsigned (unsigned)
#define RTIBOOST_TYPEOF_signed (signed)

#define char_RTIBOOST_TYPEOF (char)
#define short_RTIBOOST_TYPEOF (short)
#define int_RTIBOOST_TYPEOF (int)
#define long_RTIBOOST_TYPEOF (long)

#define RTIBOOST_TYPEOF_char_RTIBOOST_TYPEOF (char)
#define RTIBOOST_TYPEOF_short_RTIBOOST_TYPEOF (short)
#define RTIBOOST_TYPEOF_int_RTIBOOST_TYPEOF (int)
#define RTIBOOST_TYPEOF_long_RTIBOOST_TYPEOF (long)
#define RTIBOOST_TYPEOF_bool_RTIBOOST_TYPEOF (bool)
#define RTIBOOST_TYPEOF_unsigned_RTIBOOST_TYPEOF (unsigned)
#define RTIBOOST_TYPEOF_size_t_RTIBOOST_TYPEOF (size_t)

#define RTIBOOST_TYPEOF_MAKE_OBJ_char          RTIBOOST_TYPEOF_INTEGRAL_PARAM(char)
#define RTIBOOST_TYPEOF_MAKE_OBJ_short         RTIBOOST_TYPEOF_INTEGRAL_PARAM(short)
#define RTIBOOST_TYPEOF_MAKE_OBJ_int           RTIBOOST_TYPEOF_INTEGRAL_PARAM(int)
#define RTIBOOST_TYPEOF_MAKE_OBJ_long          RTIBOOST_TYPEOF_INTEGRAL_PARAM(long)
#define RTIBOOST_TYPEOF_MAKE_OBJ_bool          RTIBOOST_TYPEOF_INTEGRAL_PARAM(bool)
#define RTIBOOST_TYPEOF_MAKE_OBJ_unsigned      RTIBOOST_TYPEOF_INTEGRAL_PARAM(unsigned)
#define RTIBOOST_TYPEOF_MAKE_OBJ_size_t        RTIBOOST_TYPEOF_INTEGRAL_PARAM(size_t)
#define RTIBOOST_TYPEOF_MAKE_OBJ_unsignedchar  RTIBOOST_TYPEOF_INTEGRAL_PARAM(unsigned char)
#define RTIBOOST_TYPEOF_MAKE_OBJ_unsignedshort RTIBOOST_TYPEOF_INTEGRAL_PARAM(unsigned short)
#define RTIBOOST_TYPEOF_MAKE_OBJ_unsignedint   RTIBOOST_TYPEOF_INTEGRAL_PARAM(unsigned int)
#define RTIBOOST_TYPEOF_MAKE_OBJ_unsignedlong  RTIBOOST_TYPEOF_INTEGRAL_PARAM(unsigned long)
#define RTIBOOST_TYPEOF_MAKE_OBJ_signedchar    RTIBOOST_TYPEOF_INTEGRAL_PARAM(signed char)
#define RTIBOOST_TYPEOF_MAKE_OBJ_signedshort   RTIBOOST_TYPEOF_INTEGRAL_PARAM(signed short)
#define RTIBOOST_TYPEOF_MAKE_OBJ_signedint     RTIBOOST_TYPEOF_INTEGRAL_PARAM(signed int)
#define RTIBOOST_TYPEOF_MAKE_OBJ_signedlong    RTIBOOST_TYPEOF_INTEGRAL_PARAM(signed long)
#define RTIBOOST_TYPEOF_MAKE_OBJ_integral(x)   RTIBOOST_TYPEOF_INTEGRAL_PARAM(x)

#define RTIBOOST_TYPEOF_INTEGRAL(X) integral(X) RTIBOOST_TYPEOF_EAT
#define RTIBOOST_TYPEOF_EAT_RTIBOOST_TYPEOF
#define RTIBOOST_TYPEOF_integral(X) (integral(X))

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM(Type)\
    (INTEGRAL_PARAM)\
    (Type)

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM_GETTYPE(Param)\
    RTIBOOST_PP_SEQ_ELEM(1, Param)

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM_EXPANDTYPE(Param)\
    RTIBOOST_TYPEOF_INTEGRAL_PARAM_GETTYPE(Param)

// INTEGRAL_PARAM "virtual functions" implementation

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM_ENCODE(This, n)\
    typedef typename rtiboost::type_of::encode_integral<\
        RTIBOOST_PP_CAT(V, n),\
        RTIBOOST_TYPEOF_INTEGRAL_PARAM_GETTYPE(This),\
        RTIBOOST_PP_CAT(P, n)\
    >::type RTIBOOST_PP_CAT(V, RTIBOOST_PP_INC(n)); 

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM_DECODE(This, n)\
    typedef rtiboost::type_of::decode_integral<RTIBOOST_TYPEOF_INTEGRAL_PARAM_GETTYPE(This), RTIBOOST_PP_CAT(iter, n)> RTIBOOST_PP_CAT(d, n);\
    static const RTIBOOST_TYPEOF_INTEGRAL_PARAM_GETTYPE(This) RTIBOOST_PP_CAT(P, n) = RTIBOOST_PP_CAT(d, n)::value;\
    typedef typename RTIBOOST_PP_CAT(d, n)::iter RTIBOOST_PP_CAT(iter, RTIBOOST_PP_INC(n));

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM_PLACEHOLDER(Param)\
    (RTIBOOST_TYPEOF_INTEGRAL_PARAM_GETTYPE(Param))0

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM_DECLARATION_TYPE(Param)\
    RTIBOOST_TYPEOF_INTEGRAL_PARAM_GETTYPE(Param)

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM_PLACEHOLDER_TYPES(Param, n)\
    RTIBOOST_PP_CAT(T,n)

#define RTIBOOST_TYPEOF_INTEGRAL_PARAM_ISTEMPLATE 0

#endif//RTIBOOST_TYPEOF_INTEGRAL_TEMPLATE_PARAM_HPP_INCLUDED
